// ===== ë©”ì¸ í•¨ìˆ˜ =====
function generateSchedule() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // ì„¤ì • ì½ê¸°
  const config = readConfig(ss);
  
  // êµìœ¡ì¼ ê³„ì‚° (ê³µíœ´ì¼ ì œì™¸)
  const allDays = calculateAllDays(config.startDate, config.endDate);
  
  // ê³¼ëª© ë°°ì¹˜ ê³„íš ìƒì„±
  const schedulePlan = createSchedulePlan();
  
  // ì‹¤ì œ iOS 8íšŒì°¨ í˜•ì‹ìœ¼ë¡œ ì‹œê°„í‘œ ìƒì„± (ë³‘í•© ì—†ì´)
  outputRealFormatWithHolidayMerge(ss, allDays, schedulePlan);
  SpreadsheetApp.getUi().alert('ì‹œê°„í‘œ ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
}

// ===== ì„¤ì • ì½ê¸° =====
function readConfig(ss) {
  const configSheet = ss.getSheetByName('ì„¤ì •');
  if (!configSheet) {
    throw new Error('ì„¤ì • ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì„¤ì • ì‹œíŠ¸ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
  }
  
  const data = configSheet.getRange('A2:B6').getValues();
  return {
    startDate: new Date(data[0][1]),
    endDate: new Date(data[1][1])
  };
}

// ===== 2025ë…„ ê³µíœ´ì¼ ì •ì˜ =====
function getHolidays2025() {
  return {
    '2025-01-01': 'ì‹ ì •',
    '2025-01-28': 'ì„¤ë‚ ',
    '2025-01-29': 'ì„¤ë‚ ',
    '2025-01-30': 'ì„¤ë‚ ',
    '2025-03-01': 'ì‚¼ì¼ì ˆ',
    '2025-05-05': 'ì–´ë¦°ì´ë‚ ',
    '2025-06-06': 'í˜„ì¶©ì¼',
    '2025-08-15': 'ê´‘ë³µì ˆ',
    '2025-10-03': 'ê°œì²œì ˆ',
    '2025-10-06': 'ì¶”ì„',
    '2025-10-07': 'ì¶”ì„',
    '2025-10-08': 'ëŒ€ì²´íœ´ì¼',
    '2025-10-09': 'í•œê¸€ë‚ ',
    '2025-10-10': 'íœ´ë¬´',  // ì»¤ìŠ¤í…€ íœ´ì¼
    '2025-12-25': 'ì„±íƒ„ì ˆ'
  };
}

// ===== ëª¨ë“  í‰ì¼ ê³„ì‚° =====
function calculateAllDays(startDate, endDate) {
  const days = [];
  const holidays = getHolidays2025();
  let current = new Date(startDate);
  
  while (current <= endDate) {
    const dayOfWeek = current.getDay();
    
    // í‰ì¼ë§Œ í¬í•¨ (ì›”=1 ~ ê¸ˆ=5)
    if (dayOfWeek >= 1 && dayOfWeek <= 5) {
      const dateStr = Utilities.formatDate(current, 'Asia/Seoul', 'yyyy-MM-dd');
      const monthDay = (current.getMonth() + 1) + '/' + current.getDate();
      const weekDayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
      
      days.push({
        date: new Date(current),
        dateStr: dateStr,
        displayStr: monthDay + '(' + weekDayNames[dayOfWeek] + ')',
        isHoliday: holidays.hasOwnProperty(dateStr),
        holidayName: holidays[dateStr] || null
      });
    }
    
    current.setDate(current.getDate() + 1);
  }
  
  return days;
}

// ===== ê³¼ëª© ë°°ì¹˜ ê³„íš =====
function createSchedulePlan() {
  // ì‹¤ì œ iOS 8íšŒì°¨ ì‹œê°„í‘œì™€ ë™ì¼í•œ íŒ¨í„´
  const plan = [];
  let dayCount = 0;
  
  // 1ì£¼ì°¨: ë¯¸ë‹ˆí”„ë¡œì íŠ¸ 4ì¼ (ê¸ˆìš”ì¼ ê´‘ë³µì ˆ)
  for (let i = 0; i < 4; i++) {
    plan.push('ë¯¸ë‹ˆí”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 2ì£¼ì°¨: ì›”(ë¯¸ë‹ˆí”„ë¡œì íŠ¸) + í™”~ê¸ˆ(Swift ê¸°ì´ˆ)
  plan.push('ë¯¸ë‹ˆí”„ë¡œì íŠ¸');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('Swift ë¬¸ë²• ì¢…í•©ë°˜ - ê¸°ì´ˆ');
    dayCount++;
  }
  
  // 3ì£¼ì°¨: ì›”(Swift ê¸°ì´ˆ) + í™”~ê¸ˆ(Swift ì‹¬í™”)
  plan.push('Swift ë¬¸ë²• ì¢…í•©ë°˜ - ê¸°ì´ˆ');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('Swift ë¬¸ë²• ì¢…í•©ë°˜ - ì‹¬í™”');
    dayCount++;
  }
  
  // 4ì£¼ì°¨: ì›”(Swift ì‹¬í™”) + í™”~ê¸ˆ(iOS ì…ë¬¸)
  plan.push('Swift ë¬¸ë²• ì¢…í•©ë°˜ - ì‹¬í™”');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('iOS ì•±ê°œë°œ ì…ë¬¸');
    dayCount++;
  }
  
  // 5ì£¼ì°¨: ì „ì²´ iOS ì…ë¬¸
  for (let i = 0; i < 5; i++) {
    plan.push('iOS ì•±ê°œë°œ ì…ë¬¸');
    dayCount++;
  }
  
  // 6ì£¼ì°¨: ì›”(iOS ì…ë¬¸) + í™”~ê¸ˆ(ì£¼íŠ¹ê¸° ê¸°ì´ˆ)
  plan.push('iOS ì•±ê°œë°œ ì…ë¬¸');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ê¸°ì´ˆ í”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 7ì£¼ì°¨: ì›”(ì£¼íŠ¹ê¸° ê¸°ì´ˆ) + í™”~ê¸ˆ(iOS ìˆ™ë ¨)
  plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ê¸°ì´ˆ í”„ë¡œì íŠ¸');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('iOS ì•±ê°œë°œ ìˆ™ë ¨');
    dayCount++;
  }
  
  // 8ì£¼ì°¨: ì›”~ëª©(iOS ìˆ™ë ¨), ê¸ˆ(ê°œì²œì ˆ)
  for (let i = 0; i < 4; i++) {
    plan.push('iOS ì•±ê°œë°œ ìˆ™ë ¨');
    dayCount++;
  }
  
  // 9ì£¼ì°¨ëŠ” ì¶”ì„ ì—°íœ´ë¡œ ìŠ¤í‚µ
  
  // 10ì£¼ì°¨: ì›”(iOS ìˆ™ë ¨) + í™”~ê¸ˆ(ì£¼íŠ¹ê¸° ìˆ™ë ¨)
  plan.push('iOS ì•±ê°œë°œ ìˆ™ë ¨');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ìˆ™ë ¨ í”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 11ì£¼ì°¨: ì›”í™”(ì£¼íŠ¹ê¸° ìˆ™ë ¨) + ìˆ˜~ê¸ˆ(iOS ì‹¬í™”)
  for (let i = 0; i < 2; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ìˆ™ë ¨ í”„ë¡œì íŠ¸');
    dayCount++;
  }
  for (let i = 0; i < 3; i++) {
    plan.push('iOS ì•±ê°œë°œ ì‹¬í™”');
    dayCount++;
  }
  
  // 12ì£¼ì°¨: ì „ì²´ iOS ì‹¬í™”
  for (let i = 0; i < 5; i++) {
    plan.push('iOS ì•±ê°œë°œ ì‹¬í™”');
    dayCount++;
  }
  
  // 13ì£¼ì°¨: ì›”(iOS ì‹¬í™”) + í™”~ê¸ˆ(ì£¼íŠ¹ê¸° ì‹¬í™”)
  plan.push('iOS ì•±ê°œë°œ ì‹¬í™”');
  dayCount++;
  for (let i = 0; i < 4; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ì‹¬í™” í”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 14ì£¼ì°¨: ì›”~ìˆ˜(ì£¼íŠ¹ê¸° ì‹¬í™”) + ëª©ê¸ˆ(ì‹¤ì „)
  for (let i = 0; i < 3; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ì‹¬í™” í”„ë¡œì íŠ¸');
    dayCount++;
  }
  for (let i = 0; i < 2; i++) {
    plan.push('[í”„ë¡œì íŠ¸]ì‹¤ì „ í”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 15~18ì£¼ì°¨: ì‹¤ì „ í”„ë¡œì íŠ¸
  // ë‚˜ë¨¸ì§€ ëª¨ë“  ë‚ ì€ ì‹¤ì „ í”„ë¡œì íŠ¸
  while (dayCount < 90) {
    plan.push('[í”„ë¡œì íŠ¸]ì‹¤ì „ í”„ë¡œì íŠ¸');
    dayCount++;
  }
  
  // 18ì£¼ì°¨ ë§ˆì§€ë§‰ì— íŠ¹ê°• ì¶”ê°€
  // ë§ˆì§€ë§‰ 2ì‹œê°„ì€ ì´ë ¥ì„œ/ëª¨ì˜ë©´ì ‘/í˜‘ë ¥ì‚¬íŠ¹ê°•ìœ¼ë¡œ ëŒ€ì²´
  
  return plan;
}

// ===== ë³‘í•© ì—†ì´ ì‹¤ì œ í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ =====
function outputRealFormatWithHolidayMerge(ss, allDays, schedulePlan) {
  // ìƒˆ ì‹œíŠ¸ ìƒì„±/ì´ˆê¸°í™”
  let sheet = ss.getSheetByName('iOS_ì‹œê°„í‘œ');
  if (!sheet) sheet = ss.insertSheet('iOS_ì‹œê°„í‘œ'); else sheet.clear();

  // ì‹œê°„ëŒ€ ì •ì˜ (09:00 ~ 21:00)
  const timeSlots = [];
  for (let hour = 9; hour <= 20; hour++) {
    timeSlots.push({ start: `${String(hour).padStart(2,'0')}:00`, end: `${String(hour+1).padStart(2,'0')}:00` });
  }

  let currentRow = 1;
  let dayIndex = 0;
  let planIndex = 0;
  let weekNum = 1;

  const HOLIDAY_NAMES = ['ê´‘ë³µì ˆ','ì¶”ì„','ê°œì²œì ˆ','í•œê¸€ë‚ ','ëŒ€ì²´íœ´ì¼','íœ´ë¬´'];

  while (dayIndex < allDays.length) {
    currentRow++; // ë¹ˆ í–‰

    // ì£¼ì°¨ í—¤ë”
    sheet.getRange(currentRow, 2).setValue(`${weekNum}ì£¼ì°¨`);
    sheet.getRange(currentRow, 2, 1, 8).merge();
    sheet.getRange(currentRow, 2).setHorizontalAlignment('center').setFontWeight('bold').setBackground('#d9ead3').setFontSize(11);
    currentRow++;

    // ì´ë²ˆ ì£¼ ë‚ ì§œ/ê³¼ëª© ìˆ˜ì§‘
    const weekDates = [];
    const weekSubjects = [];

    for (let i = 0; i < 5 && dayIndex < allDays.length; i++) {
      const day = allDays[dayIndex];
      weekDates.push(day.displayStr);

      if (day.isHoliday) {
        weekSubjects.push(day.holidayName);
      } else if (planIndex < schedulePlan.length) {
        weekSubjects.push(schedulePlan[planIndex]);
        planIndex++;
      } else {
        weekSubjects.push(''); // ë‚¨ëŠ” ì¹¸ ë³´í˜¸
      }
      dayIndex++;
    }

    // ë‚ ì§œ í–‰
    currentRow++;
    for (let i = 0; i < weekDates.length; i++) {
      sheet.getRange(currentRow, 5 + i).setValue(weekDates[i]);
    }
    sheet.getRange(currentRow, 5, 1, 5).setHorizontalAlignment('center').setFontWeight('bold').setBackground('#fff2cc');
    currentRow++;

    // ì‹œê°„ í—¤ë”
    sheet.getRange(currentRow, 2).setValue('ì‹œì‘ì‹œê°„');
    sheet.getRange(currentRow, 4).setValue('ì¢…ë£Œì‹œê°„');
    sheet.getRange(currentRow, 2, 1, 3).setBackground('#f4cccc').setFontWeight('bold');
    currentRow++;

    // ì´ ì£¼ì˜ ì‹œê°„ ë¸”ë¡ ì‹œì‘ í–‰(íœ´ì¼ ë³‘í•©ì— í•„ìš”)
    const weekTimeStartRow = currentRow;

    // ì‹œê°„ë³„ ì±„ìš°ê¸° (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
    timeSlots.forEach((slot, slotIndex) => {
      sheet.getRange(currentRow, 2).setValue(slot.start);
      sheet.getRange(currentRow, 3).setValue('~');
      sheet.getRange(currentRow, 4).setValue(slot.end);

      weekSubjects.forEach((subject, dayIdx) => {
        const cell = sheet.getRange(currentRow, 5 + dayIdx);
        if (!subject) return;

        // [íŠ¹ê°•]/ëª¨ì˜ë©´ì ‘/í˜‘ë ¥ì‚¬ íŠ¹ê°•/íœ´ì¼ ë“±ì˜ ê¸°ì¡´ ë¶„ê¸° ìœ ì§€
        if (weekNum === 1 && dayIdx === 2 && (slot.start === '15:00' || slot.start === '16:00')) {
          cell.setValue('[íŠ¹ê°•] GIT íŠ¹ê°•').setBackground('#e6b8af');
        } else if (weekNum === 18 && dayIdx === 4) {
          if (slotIndex < 10) cell.setValue('ì´ë ¥ì„œ ì‘ì„±').setBackground('#cfe2f3');
          else cell.setValue('ëª¨ì˜ë©´ì ‘').setBackground('#b4a7d6');
        } else if (weekNum === 18 && dayIdx === 3) {
          if (slotIndex >= 6) cell.setValue('ëª¨ì˜ë©´ì ‘').setBackground('#b4a7d6');
          else cell.setValue(subject);
        } else if (weekNum === 18 && dayIdx === 0 && (slot.start === '19:00' || slot.start === '20:00')) {
          cell.setValue('í˜‘ë ¥ì‚¬ íŠ¹ê°•').setBackground('#d9d2e9');
        } else if (HOLIDAY_NAMES.includes(subject)) {
          cell.setValue(subject).setBackground('#ea9999').setFontColor('#cc0000').setFontWeight('bold');
        } else {
          cell.setValue(subject).setHorizontalAlignment('center').setVerticalAlignment('middle');
        }
      });

      currentRow++;
    });

    // â¬‡ï¸ íœ´ì¼ ì¹¸ ë³‘í•©(ì„¸ë¡œ ë³‘í•©: í•´ë‹¹ ìš”ì¼ ì»¬ëŸ¼ì˜ ì‹œê°„ êµ¬ê°„ ì „ì²´)
    for (let dayIdx = 0; dayIdx < weekSubjects.length; dayIdx++) {
      const subj = weekSubjects[dayIdx];
      if (HOLIDAY_NAMES.includes(subj)) {
        const rng = sheet.getRange(weekTimeStartRow, 5 + dayIdx, timeSlots.length, 1);
        rng.merge();
        rng.setHorizontalAlignment('center').setVerticalAlignment('middle');
        // ìƒ‰/ê¸€ê¼´ì€ ì²« ì…€ ê°’ì— ì´ë¯¸ ì ìš©ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ í‘œì‹œë¨
      }
    }

    weekNum++;
  }

  // ì „ì²´ ì„œì‹
  sheet.autoResizeColumns(2, 8);
  sheet.setColumnWidth(1, 30);
  sheet.setColumnWidth(2, 80);
  sheet.setColumnWidth(3, 30);
  sheet.setColumnWidth(4, 80);
  for (let col = 5; col <= 9; col++) sheet.setColumnWidth(col, 150);

  // ê²€ìˆ˜ ì‹œíŠ¸ ìƒì„±/ê°±ì‹ 
  addSummarySheet(ss);
}

// ===== ê²€ìˆ˜ìš© ìš”ì•½ ì‹œíŠ¸ ìƒì„± =====
function addSummarySheet(ss) {
  let summarySheet = ss.getSheetByName('ê²€ìˆ˜_ìš”ì•½');
  if (!summarySheet) {
    summarySheet = ss.insertSheet('ê²€ìˆ˜_ìš”ì•½');
  } else {
    summarySheet.clear();
  }
  
  // í—¤ë”
  const headers = [['ê³¼ëª©ëª…', 'ê³„íš ì‹œìˆ˜', 'ì‹¤ì œ ì‹œìˆ˜', 'ì°¨ì´']];
  summarySheet.getRange(1, 1, 1, 4).setValues(headers);
  summarySheet.getRange(1, 1, 1, 4)
    .setBackground('#4285f4')
    .setFontColor('#ffffff')
    .setFontWeight('bold');
  
  // ê³¼ëª©ë³„ ì‹œìˆ˜ ì •ì˜
  const subjectHours = [
    ['ë¯¸ë‹ˆí”„ë¡œì íŠ¸', 58],
    ['Swift ë¬¸ë²• ì¢…í•©ë°˜ - ê¸°ì´ˆ', 60],
    ['Swift ë¬¸ë²• ì¢…í•©ë°˜ - ì‹¬í™”', 60],
    ['iOS ì•±ê°œë°œ ì…ë¬¸', 120],
    ['[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ê¸°ì´ˆ í”„ë¡œì íŠ¸', 60],
    ['iOS ì•±ê°œë°œ ìˆ™ë ¨', 108],
    ['iOS ì•±ê°œë°œ ì‹¬í™”', 108],
    ['[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ìˆ™ë ¨ í”„ë¡œì íŠ¸', 72],
    ['[í”„ë¡œì íŠ¸]ì£¼íŠ¹ê¸° ì‹¬í™” í”„ë¡œì íŠ¸', 84],
    ['[í”„ë¡œì íŠ¸]ì‹¤ì „ í”„ë¡œì íŠ¸', 328],
    ['[íŠ¹ê°•] GIT íŠ¹ê°•', 2],
    ['ì´ë ¥ì„œ ì‘ì„±', 10],
    ['ëª¨ì˜ë©´ì ‘', 8],
    ['í˜‘ë ¥ì‚¬ íŠ¹ê°•', 2]
  ];
  
  // ë°ì´í„° ì…ë ¥
  let row = 2;
  subjectHours.forEach(([subject, plannedHours]) => {
    summarySheet.getRange(row, 1).setValue(subject);
    summarySheet.getRange(row, 2).setValue(plannedHours);
    
    // COUNTIF ìˆ˜ì‹ìœ¼ë¡œ ì‹¤ì œ ì‹œìˆ˜ ê³„ì‚°
    const formula = `=COUNTIF('iOS_ì‹œê°„í‘œ'!E:I,"${subject}")`;
    summarySheet.getRange(row, 3).setFormula(formula);
    
    // ì°¨ì´ ê³„ì‚°
    summarySheet.getRange(row, 4).setFormula(`=C${row}-B${row}`);
    
    row++;
  });
  
  // í•©ê³„ í–‰
  summarySheet.getRange(row, 1).setValue('í•©ê³„');
  summarySheet.getRange(row, 2).setFormula(`=SUM(B2:B${row-1})`);
  summarySheet.getRange(row, 3).setFormula(`=SUM(C2:C${row-1})`);
  summarySheet.getRange(row, 4).setFormula(`=C${row}-B${row}`);
  
  summarySheet.getRange(row, 1, 1, 4)
    .setBackground('#ffe599')
    .setFontWeight('bold');
  
  // ì„œì‹ ì¡°ì •
  summarySheet.autoResizeColumns(1, 4);
  
  // ì¡°ê±´ë¶€ ì„œì‹ (ì°¨ì´ê°€ 0ì´ ì•„ë‹ˆë©´ ë¹¨ê°„ìƒ‰)
  const range = summarySheet.getRange(2, 4, row-1, 1);
  const rule = SpreadsheetApp.newConditionalFormatRule()
    .whenNumberNotEqualTo(0)
    .setBackground('#ff9999')
    .setRanges([range])
    .build();
  
  summarySheet.setConditionalFormatRules([rule]);
}

// ===== ë©”ë‰´ ì¶”ê°€ =====
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('ğŸ“… ì‹œê°„í‘œ ìë™í™”')
    .addItem('ğŸ“Š ì‹œê°„í‘œ ìƒì„±í•˜ê¸°', 'generateSchedule')
    .addItem('âš™ï¸ ì„¤ì • ì‹œíŠ¸ ë§Œë“¤ê¸°', 'createConfigSheets')
    .addSeparator()
    .addItem('âœ… ì‹œìˆ˜ ê²€ì¦í•˜ê¸°', 'verifyHours')
    .addItem('â„¹ï¸ ë„ì›€ë§', 'showHelp')
    .addToUi();
}

// ===== ì‹œìˆ˜ ê²€ì¦ í•¨ìˆ˜ =====
function verifyHours() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const summarySheet = ss.getSheetByName('ê²€ìˆ˜_ìš”ì•½');
  
  if (!summarySheet) {
    SpreadsheetApp.getUi().alert('ë¨¼ì € ì‹œê°„í‘œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
    return;
  }
  
  // í•©ê³„ í™•ì¸
  const totalPlanned = summarySheet.getRange('B16').getValue();
  const totalActual = summarySheet.getRange('C16').getValue();
  const totalDiff = summarySheet.getRange('D16').getValue();
  
  let message = `ê²€ì¦ ê²°ê³¼:\n\n`;
  message += `ê³„íšëœ ì´ ì‹œìˆ˜: ${totalPlanned}ì‹œê°„\n`;
  message += `ì‹¤ì œ ë°°ì¹˜ëœ ì‹œìˆ˜: ${totalActual}ì‹œê°„\n`;
  message += `ì°¨ì´: ${totalDiff}ì‹œê°„\n\n`;
  
  if (totalDiff === 0) {
    message += 'âœ… ì‹œìˆ˜ê°€ ì •í™•í•˜ê²Œ ë°°ì¹˜ë˜ì—ˆìŠµë‹ˆë‹¤!';
  } else {
    message += 'âš ï¸ ì‹œìˆ˜ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤. ê²€ìˆ˜_ìš”ì•½ ì‹œíŠ¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
  }
  
  SpreadsheetApp.getUi().alert('ì‹œìˆ˜ ê²€ì¦ ê²°ê³¼', message, SpreadsheetApp.getUi().ButtonSet.OK);
}

// ===== ì„¤ì • ì‹œíŠ¸ ìƒì„± =====
function createConfigSheets() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // ì„¤ì • ì‹œíŠ¸ ìƒì„±
  let configSheet = ss.getSheetByName('ì„¤ì •');
  if (!configSheet) {
    configSheet = ss.insertSheet('ì„¤ì •');
  } else {
    configSheet.clear();
  }
  
  const configData = [
    ['í•­ëª©', 'ê°’'],
    ['ê¸°ìˆ˜ ì‹œì‘ì¼', '2025-08-11'],
    ['ê¸°ìˆ˜ ì¢…ë£Œì¼', '2025-12-23'],
    ['', ''],
    ['â€» ë‚ ì§œëŠ” YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”', ''],
    ['â€» ê³µíœ´ì¼ì€ ìë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤', '']
  ];
  
  configSheet.getRange(1, 1, configData.length, 2).setValues(configData);
  
  // í—¤ë” ì„œì‹
  configSheet.getRange(1, 1, 1, 2)
    .setBackground('#4285f4')
    .setFontColor('#ffffff')
    .setFontWeight('bold');
  
  // ì„¤ëª… ì„œì‹
  configSheet.getRange(5, 1, 2, 1)
    .setFontColor('#666666')
    .setFontSize(9);
  
  configSheet.autoResizeColumns(1, 2);
  
  SpreadsheetApp.getUi().alert('âœ… ì„¤ì • ì‹œíŠ¸ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì´ì œ "ì‹œê°„í‘œ ìƒì„±í•˜ê¸°"ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.');
}

// ===== ë„ì›€ë§ =====
function showHelp() {
  const message = `iOS ì‹œê°„í‘œ ìë™í™” ì‚¬ìš©ë²•:

1. ë¨¼ì € "ì„¤ì • ì‹œíŠ¸ ë§Œë“¤ê¸°"ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”
2. ì„¤ì • ì‹œíŠ¸ì—ì„œ ë‚ ì§œë¥¼ ìˆ˜ì •í•˜ì„¸ìš”
3. "ì‹œê°„í‘œ ìƒì„±í•˜ê¸°"ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”
4. "ì‹œìˆ˜ ê²€ì¦í•˜ê¸°"ë¡œ ê²€ìˆ˜í•˜ì„¸ìš”

íŠ¹ì§•:
- ëª¨ë“  ì…€ì— ê³¼ëª©ëª…ì´ ì…ë ¥ë©ë‹ˆë‹¤ (ë³‘í•© ì—†ìŒ)
- COUNTIF í•¨ìˆ˜ë¡œ ì‹œìˆ˜ ê²€ì¦ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤
- ê²€ìˆ˜_ìš”ì•½ ì‹œíŠ¸ì—ì„œ ìë™ ì§‘ê³„ë©ë‹ˆë‹¤

ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë‹´ë‹¹ìì—ê²Œ ì—°ë½ì£¼ì„¸ìš”.`;
  
  SpreadsheetApp.getUi().alert('ğŸ“– ì‚¬ìš© ì•ˆë‚´', message, SpreadsheetApp.getUi().ButtonSet.OK);
}
